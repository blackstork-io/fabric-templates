document "offsec_oswp_exam_report" {

  meta {
    name = "Offensive Security OSWP Exam Documentation"

    author = "Sergey Polzunov <sergey@blackstork.io>"

    description = <<-EOT
      The Offensive Security OSWP exam documentation contains all efforts that
      were conducted in order to pass the Offensive Security Wireless
      Professional exam. This report will be graded from a standpoint of
      correctness and fullness to all aspects of the exam. The purpose of this
      report is to ensure that the student has the technical knowledge required
      to pass the qualifications for the Offensive Security Wireless Professional
      certification.

      References:
        - https://www.offsec.com/courses/pen-210/
        - https://www.offsec.com/wifu/OSWP-Exam-Report.docx
        - https://github.com/noraj/OSCP-Exam-Report-Template-Markdown/blob/master/src/OSWP-exam-report-template_OS_v1.md
    EOT

    url = "https://www.offsec.com/courses/pen-210/"
    # version = "v.1.0"

    license = "MIT License"
    tags = ["pentesting", "offsec", "oswp", "pen-210"]

    updated_at = "2024-04-20T10:46:51+0000"
  }

  data inline "findings" {

    access_points = [
      {
        access_point = "Access Point X"
        summary = <<-EOT
          A brief description of the attack chain with machine names, including
          the depth of compromise should be included here.
        EOT
        network_key = "DE:AD:CA:FE:BA:BE:99:77:55:33:11:88:66"
        proof_txt = "b78066a8ec18b4182da1209471a6ce95"
        screenshots = ["../../img-placeholder.png"]
        steps = <<-EOT
          Provide a detailed account of your methodology in obtaining the
          “Access Point X” wireless network key. The steps taken should be able
          to be easily followed and reproducible if necessary.

          **1. Placed interface in monitor mode.**
          Commands and screenshots.

          **2. Next step.**

          ![Some tool screenshot](../../img-placeholder.png)

          **3. Crack the key using the 123 cracking tool.**

          ![Aircrack-ng screenshot](../../img-placeholder.png)
        EOT
      },
    ]
  }

  title = "Offensive Security OSWP Exam Documentation"

  content frontmatter {
    content = {
      title = "Offensive Security OSWP Exam Documentation",
      # FIXME: fix is coming in https://github.com/blackstork-io/fabric/pull/155
      #  author = {
      #    email = "student@youremailaddress.com",
      #    osid = "XXXXX"
      #  },
      author = "student@youremailaddress.com",
      version = "v.1.0"
    }
  }

  content toc {
    start_level = 1
  }

  section "intro" {
    title = "Offensive Security OSWP Exam Documentation"

    content text {
      value = <<-EOT
        The Offensive Security OSWP exam documentation contains all efforts
        that were conducted in order to pass the Offensive Security Wireless
        Professional exam. This report will be graded from a standpoint of
        correctness and fullness to all aspects of the exam. The purpose of
        this report is to ensure that the student has the technical knowledge
        required to pass the qualifications for the Offensive Security Wireless
        Professional certification.

        You are required to fill out this exam documentation fully and to include
        the following sections:

        - Methodology walkthrough and detailed outline of steps taken
        - Each finding with included screenshots, walkthrough, and sample commands
        - Any additional items that were not included
      EOT
    }
  }

  # FIXME: should be a loop with condition checks
  # https://github.com/blackstork-io/fabric/issues/142
  section "ap_findings_0" {
    title = "{{ (index .data.inline.findings.access_points 0).access_point }}"

    section "proofs" {
      title = "Proof"

      content text {
        query = ".data.inline.findings.access_points[0]"

        value = <<-EOT
          {{ with .query_result.network_key }}
          **Wireless Network Key**: `{{ . }}`
          {{ end -}}

          {{- with .query_result.proof_txt }}
          **proof.txt**: `{{ . }}`
          {{ end -}}
        EOT
      }
    }

    section "screenshots" {
      title = "Screenshots"

      content text {
        value = <<-EOT
          Provide at least one screenshot of the successfully cracked “Access
          Point X" wireless network key and a screenshot of proof.txt.
        EOT
      }

      #FIXME: this should be a loop
      content image {
        src = "{{ (index (index .data.inline.findings.access_points 0).screenshots 0)}}"
      }
    }

    section "steps" {
      title = "Steps"

      content text {
        value = "{{ (index .data.inline.findings.access_points 0).steps }}"
      }
    }
  }

  section {
    base = section.offsec_exam_additional_info
  }
}

document "offsec_osee_exam_report" {

  meta {
    name = "Offensive Security OSEE Exam Report"

    author = "Sergey Polzunov <sergey@blackstork.io>"

    description = <<-EOT
      The Offensive Security OSEE exam documentation contains all efforts that
      were conducted in order to pass the Offensive Security Exploitation Expert
      exam. This report will be graded from a standpoint of correctness and
      fullness to all aspects of the exam. The purpose of this report is to
      ensure that the student has the technical knowledge required to pass the
      qualifications for the Offensive Security Exploitation Expert
      certification.

      References:
        - https://www.offsec.com/
        - https://www.offsec.com/awe/AWE-Exam-Report.docx
        - https://github.com/noraj/OSCP-Exam-Report-Template-Markdown/blob/master/src/OSEE-exam-report-template_OS_v1.md
    EOT

    url = "https://www.offsec.com/courses/exp-401/"
    # version = "v.2.0"

    license = "MIT License"
    tags = ["pentesting", "offsec", "exam", "osee", "exp-401"]

    updated_at = "2024-04-27T13:06:51+0000"
  }

  data inline "findings" {
  }

  title = "OSEE Exam Documentation"

  content frontmatter {
    content = {
      title = "Offensive Security OSEE Exam Report",
      # FIXME: fix is coming in https://github.com/blackstork-io/fabric/pull/155
      #  author = {
      #    email = "student@youremailaddress.com",
      #    osid = "XXXXX"
      #  },
      author = "student@youremailaddress.com",
      # FIXME: version should be picked from the template metadata
      version = "v.1.0"
    }
  }

  content toc {
    start_level = 1
    end_level = 4
  }

  section "description" {
    title = "Offensive Security OSEE Exam Documentation"

    content text {
      value = <<-EOT
        The Offensive Security OSEE exam documentation contains all efforts that
        were conducted in order to pass the Offensive Security Exploitation
        Expert exam. This report will be graded from a standpoint of correctness
        and fullness to all aspects of the exam. The purpose of this report is to
        ensure that the student has the technical knowledge required to pass the
        qualifications for the Offensive Security Exploitation Expert
        certification.

        The student will be required to fill out this exam documentation fully
        and to include the following sections:

        - Methodology walkthrough and detailed outline of steps taken
        - Each finding with included screenshots, walkthrough, sample code, and
          proof.txt if applicable.
        - Any additional items that were not included
      EOT
    }
  }

  # FIXME: this should be a loop
  section "target_1" {
    title = "192.168.XX.11 (25 or 50 Points)"

    section "proof" {
      title = "Proof.txt"

      content text {
        value = "Provide the contents of proof.txt"
      }
    }

    section "initial_exploitation" {
      title = "Initial Exploitation"

      content text {
        value = "Explain the research performed and steps taken to perform initial exploitation with the provided CVE"
      }
    }

    section "read_write_primitive" {
      title = "Read and Write Primitive"

      content text {
        value = "Explain the research performed and steps taken to create a read and write primitive including ASLR bypass"
      }
    }

    section "code_execution" {
      title = "Code Execution"

      content text {
        value = <<-EOT
          Explain the research performed and steps taken to bypass all the
          mitigations excluding the sandbox and obtain code execution. Also
          include the execution of an arbitrary Win32 API if only partial
          solution is provided.
        EOT
      }
    }

    section "sandbox_escape" {
      title = "Sandbox Escape"

      content text {
        value = <<-EOT
          Explain the research performed and steps taken to escape the sandbox
          and obtain a reverse shell.
        EOT
      }
    }

    section "proof_of_concept" {
      title = "Proof Of Concept"

      content text {
        value = <<-EOT
          Provide the code of your final exploit.

          ```bash
          code
          ```
        EOT
      }
    }

    section "screenshots" {
      title = "Screenshots"

      content text {
        value = "Provide a screenshot of the ipconfig command and the contents of proof.txt"
      }

      content image {
        src = "./img-placeholder.png"
      }

      content image {
        src = "./img-placeholder.png"
      }
    }
  }

  section "target_2" {
    title = "192.168.XX.63 (25 or 50 Points)"

    section "proof" {
      title = "Proof.txt"

      content text {
        value = "Provide the contents of proof.txt"
      }
    }

    section "race_condition" {
      title = "Race Condition"

      content text {
        value = "Explain the research performed and steps taken to perform initial exploitation with the provided CVE"
      }
    }

    section "kernel_memory_leak" {
      title = "Kernel Memory Leak"

      content text {
        value = "Explain the research performed and steps taken to perform a kernel memory leak with the provided CVE"
      }
    }

    section "read_write_primitive" {
      title = "Read and Write Primitive"

      content text {
        value = <<-EOT
          Explain the research performed and steps taken to create a kernel
          mode read and write primitive if you are submitting the full
          solution.
        EOT
      }
    }

    section "privilege_escalation" {
      title = "Privilege Escalation"

      content text {
        value = <<-EOT
          Explain the research performed and steps taken to escalate your
          privileges to SYSTEM if you are submitting the full solution.
        EOT
      }
    }

    section "proof_of_concept" {
      title = "Proof Of Concept"

      content text {
        value = <<-EOT
          Provide the code of your final exploit.

          ```bash
          code
          ```
        EOT
      }
    }

    section "screenshots" {
      title = "Screenshots"

      content text {
        value = "Provide a screenshot of the ipconfig command and the contents of proof.txt"
      }

      content image {
        src = "./img-placeholder.png"
      }

      content image {
        src = "./img-placeholder.png"
      }
    }
  }

  section {
    base = section.offsec_exam_additional_info
  }
}

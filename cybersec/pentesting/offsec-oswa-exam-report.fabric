document "offsec_oswa_exam_report" {

  meta {
    name = "Offensive Security OSWA Exam Documentation"

    authors = ["Sergey Polzunov <sergey@blackstork.io>"]

    description = <<-EOT
      The OffSec Web Assessor exam report contains all efforts that were
      conducted in order to pass the OffSec Web Assessor exam. This report will
      be graded from a standpoint of correctness and fullness to all aspects of
      the exam. The purpose of this report is to ensure that the student has the
      technical knowledge required to pass the qualifications for the OffSec Web
      Assessor certification

      References:
        - https://www.offsec.com/
        - https://www.offsec.com/courses/web-200/
        - https://www.offsec.com/oswa-online/OSWA-Exam-Report.docx
        - https://github.com/noraj/OSCP-Exam-Report-Template-Markdown/blob/master/src/OSWA-exam-report-template_OS_v1.md
    EOT

    url = "https://www.offsec.com/courses/web-200/"
    version = "2.0"

    license = "MIT License"
    tags = ["pentesting", "offsec", "exam", "osmr", "exp-312"]

    updated_at = "2024-04-27T13:06:51+0000"
  }

  vars {
    hosts = [
      {
        host = "192.168.X.1",
        local_txt = "local-txt-content",
        proof_txt = "proof-txt-content",
        vulnerabilities = [
          {
            name = "Vulnerability 1",
            desc = <<-EOT
              Provide the method and code used to find the vulnerability 1.
            EOT
          },
          {
            name = "Vulnerability 2",
            desc = <<-EOT
              Provide the method and code used to find the vulnerability 2.
            EOT
          },
        ],
        screenshots = ["./img-placeholder.png"]
        steps = <<-EOT
          Provide a detailed account of your methodology in creating the
          exploits. The steps taken should be able to be easily followed and
          reproducible if necessary.
        EOT
      }
    ]
  }

  title = "Offensive Security OSWA Exam Documentation"

  content frontmatter {
    content = {
      title = "Offensive Security OSWA Exam Documentation",
      author = {
        email = "student@youremailaddress.com",
        osid = "XXXXX"
      },
    }
  }

  content toc {
    start_level = 1
    end_level = 4
  }

  section "description" {
    title = "OffSec Web Assessor Exam Report"

    content text {
      value = <<-EOT
        The OffSec Web Assessor exam report contains all efforts that were
        conducted in order to pass the OffSec Web Assessor exam. This report will
        be graded from a standpoint of correctness and fullness to all aspects of
        the exam. The purpose of this report is to ensure that the student has
        the technical knowledge required to pass the qualifications for the
        OffSec Web Assessor certification

        The student will be required to fill out this exam documentation fully
        and to include the following sections:
        - Methodology walkthrough and detailed outline of steps taken
        - Each finding with included screenshots, walkthrough, sample code, and
          proof.txt if applicable.
        - Any additional items that were not included
      EOT
    }
  }

  section "summary" {
    title = "High-Level Summary"

    content text {
      value = <<-EOT
        A brief description of the assignments that were solved, including the overall exploitation steps.

        {{ range $index, $a := .vars.assignments }}
        *Assignment {{ add $index 1 }}:*
        {{ $a.exploitation_steps_summary }}
        {{ end }}

      EOT
    }
  }

  section "host_findings_0" {

    vars {
      host = query_jq(".vars.hosts[0]")
    }

    title = "{{ .vars.host.host }}"

    section "proofs" {
      title = "Local.txt / Proof.txt"

      content text {
        value = <<-EOT
          {{ with .vars.host.local_txt }}
          **local.txt**: `{{ . }}`
          {{ end -}}

          {{- with .vars.host.proof_txt }}
          **proof.txt**: `{{ . }}`
          {{ end -}}

          {{- if not (or .vars.host.local_txt .vars.host.proof_txt) }}
          No proofs were obtained.
          {{ end -}}
        EOT
      }
    }

    section ref "vulnerability_1" {
      base = section.offsec_vulnerability_details

      vars {
        vuln = query_jq(".vars.host.vulnerabilities[0]")
      }
    }

    section ref "vulnerability_2" {
      base = section.offsec_vulnerability_details

      vars {
        vuln = query_jq(".vars.host.vulnerabilities[1]")
      }
    }

    section "screenshots" {
      title = "Screenshots"

      content text {
        value = <<-EOT
          Provide screenshots of local.txt and proof.txt contents as stated in
          the Exam Control Panel Objectives.
        EOT
      }

      content image {
        local_var = query_jq(".vars.host.screenshots[0]")
        src = "{{ .vars.local }}"
      }
    }

    section "steps" {
      title = "Steps"

      content text {
        value = "{{ .vars.host.steps }}"
      }
    }
  }
}
